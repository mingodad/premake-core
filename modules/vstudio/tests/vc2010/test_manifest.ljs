//
// tests/actions/vstudio/vc2010/test_manifest.ljs
// Validate generation of Manifest block in Visual Studio 201x C/C++ projects.
// Copyright (c) 2009-2013 Jason Perkins and the Premake project
//

	var p = premake;
	var suite = test.declare("vs2010_manifest");
	var vc2010 = p.vstudio.vc2010;
	var project = p.project;


//
// Setup
//

	var wks, prj;

	function suite.setup() {
		p.action.set("vs2010");
		wks, prj = test.createWorkspace();
		kind ("ConsoleApp");
	}

	var function prepare(platform) {
		var cfg = test.getconfig(prj, "Debug", platform);
		vc2010.manifest(cfg);
	}


//
// Check the basic element structure with default settings.
//

	function suite.defaultSettings() {
		files ({ "source/test.manifest" });
		prepare();
		test.capture ([=[
<Manifest>
	<AdditionalManifestFiles>source/test.manifest;%(AdditionalManifestFiles)</AdditionalManifestFiles>
</Manifest>
		]=]);
	}

//
// Check that there is no manifest when using static lib
//

	function suite.staticLib() {
		kind ("StaticLib");
		files ({ "test.manifest" });
		prepare();
		test.isemptycapture();
	}

//
// Check that DPI Awareness emits correctly
//

	function suite.dpiAwareness_None() {
		dpiawareness ("None");
		prepare();
		test.capture ([=[
<Manifest>
	<EnableDpiAwareness>false</EnableDpiAwareness>
</Manifest>
		]=]);
	}

	function suite.dpiAwareness_High() {
		dpiawareness ("High");
		prepare();
		test.capture ([=[
<Manifest>
	<EnableDpiAwareness>true</EnableDpiAwareness>
</Manifest>
		]=]);
	}

	function suite.dpiAwareness_HighPerMonitor() {
		dpiawareness ("HighPerMonitor");
		prepare();
		test.capture ([=[
<Manifest>
	<EnableDpiAwareness>PerMonitorHighDPIAware</EnableDpiAwareness>
</Manifest>
		]=]);
	}
