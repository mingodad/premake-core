//
// tests/workspace/test_eachconfig.ljs
// Automated test suite for the workspace-level configuration iterator.
// Copyright (c) 2012-2015 Jason Perkins and the Premake project
//

	var suite = test.declare("workspace_eachconfig");

	var p = premake;


//
// Setup and teardown
//

	var wks;

	function suite.setup() {
		wks = workspace("MyWorkspace");
	}

	var function prepare() {
		p.w("-");
		for( cfg in p.workspace.eachconfig(wks) ) {
			p.w("%s:%s", cfg.buildcfg || "", cfg.platform || "");
		}
		p.w("-");
	}


//
// All configurations listed at the workspace level should be enumerated.
//

	function suite.listsBuildConfigurations_onWorkspaceLevel() {
		configurations ({ "Debug", "Release" });
		project("MyProject");
		prepare();
		test.capture ([=[
-
Debug:
Release:
-
		]=]);
	}


//
// Iteration order should be build configurations, then platforms.
//

	function suite.listsInOrder_onBuildConfigsAndPlatforms() {
		configurations ({ "Debug", "Release" });
		platforms ({ "x86", "x86_64" });
		project("MyProject");
		prepare();
		test.capture ([=[
-
Debug:x86
Debug:x86_64
Release:x86
Release:x86_64
-
		]=]);
	}


//
// Configurations listed at the project level should *not* be included
// in the workspace-level lists.
//

	function suite.excludesProjectLevelConfigs() {
		configurations ({ "Debug", "Release" });
		project ("MyProject");
		configurations ({ "PrjDebug", "PrjRelease" });
		platforms ({ "x86", "x86_64" });
		prepare();
		test.capture ([=[
-
Debug:
Release:
-
		]=]);
	}
